<!DOCTYPE html>
<html>
<head>
    <title>Ding ðŸ””</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='ding.png') }}" type="image/png">
    <link rel="shortcut icon" href="{{ url_for('static', filename='ding.png') }}" type="image/png">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='ding.png') }}" type="image/png">
    <meta name="description" content="A Search Engine named Ding made by BARTEKK23.">
</head>
<body>
    <div class="container">
        <h1>Ding <img src="{{ url_for('static', filename='ding.png') }}" alt="Ding Icon" sizes="16x16"></h1>

        <!-- User Info -->
        {% if session.get('username') %}
            <p>Hello, {{ session.username }}! <a href="{{ url_for('logout') }}">Logout</a></p>
        {% else %}
            <p><a href="{{ url_for('login') }}">Login</a> | <a href="{{ url_for('register') }}">Register</a></p>
        {% endif %}

        <!-- Search Form -->
        <form method="POST">
            <input type="text" name="query" placeholder="Search Ding..." required>
            <button type="submit">Search</button>
        </form>

        <!-- Results -->
        {% if results %}
            <h2>Results:</h2>
            <ul>
                {% for r in results %}
                    <li><a href="{{ r.url }}" target="_blank">{{ r.title }}</a></li>
                {% endfor %}
            </ul>
        {% else %}
            {% if request.method == "POST" %}
                <p>No results found.</p>
            {% endif %}
        {% endif %}

        <!-- Add Page Button (only if logged in) -->
        {% if session.get('username') %}
            <button onclick="document.getElementById('addForm').style.display='block'" class="add-page-btn">Add Page</button>

            <!-- Add Page Form -->
            <div id="addForm" style="display:none; margin-top:20px;">
                <form method="POST" action="/add">
                    <input type="text" name="title" placeholder="Page Title" required>
                    <input type="text" name="url" placeholder="Page URL" required>
                    <textarea name="content" placeholder="Page Content" required></textarea>
                    <input type="hidden" name="token" value="{{ session.token }}">
                    <button type="submit">Add Page</button>
                </form>
            </div>
        {% else %}
            <p>Login to add pages.</p>
        {% endif %}
    </div>
</body>
</html>
